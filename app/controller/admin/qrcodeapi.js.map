{
    "version": 3,
    "sources": [
        "../../../src/controller/admin/qrcodeapi.js"
    ],
    "names": [
        "Base",
        "require",
        "module",
        "exports",
        "__before",
        "isLogined",
        "console",
        "log",
        "redirect",
        "qrcodeSayConfigAction",
        "filePath",
        "think",
        "ROOT_PATH",
        "config_qiniu",
        "config",
        "config_domain",
        "domain",
        "assign",
        "display",
        "insertUrlToQrcodesayDataAction",
        "isPost",
        "ctx",
        "status",
        "message",
        "img_url",
        "post",
        "img_type",
        "isInsertOk",
        "model",
        "insertImgUrl",
        "obj",
        "Object",
        "result_code",
        "result_msg",
        "json",
        "getQrcodesayConfigDataAction",
        "qrCodeSayConfigData",
        "getQrCodeSayList",
        "saveQrCodeSayConfigAction",
        "id",
        "view_numbs",
        "tap_liked_numbs",
        "addID",
        "add",
        "error",
        "response",
        "isError",
        "msg",
        "newData",
        "where",
        "select",
        "JSON",
        "stringify",
        "updateQrCodeSayConfigAction",
        "affectedRows",
        "update",
        "deleteQrCodeSayAction",
        "delete",
        "success",
        "userInfo",
        "session",
        "isEmpty"
    ],
    "mappings": "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",
    "file": "../../../src/controller/admin/qrcodeapi.js",
    "sourcesContent": [
        "const Base = require('../base');\nmodule.exports = class extends Base {\n    async __before() {\n        var isLogined = await this.isLogined();\n        console.log('__before isLogined = ' + isLogined);\n        if (!isLogined) {\n            return this.redirect('/admin/manager/');\n        }\n    }\n\n    /*********************图片上传start*********************************** */\n    /**\n     * 码上说模块配置页面\n     * http://127.0.0.1:8360/admin/qrcodeapi/qrcodeSayConfig\n     */\n    async qrcodeSayConfigAction() {\n        var filePath = `${think.ROOT_PATH}/view/admin/code_say_config.html`;\n        var config_qiniu = this.config('qiniu');\n        var config_domain = config_qiniu.domain;\n        console.log('qrcodeSayConfigAction config_domain  ====> ', config_domain);\n        this.assign('config_domain', config_domain);\n        return this.display(filePath);\n    }\n\n    /**\n     * http://127.0.0.1:8360/admin/qrcodeapi/insertUrlToQrcodesayData\n     */\n    async insertUrlToQrcodesayDataAction() {\n        //获取post 请求参数,如果不是post请求返回\n        if (!this.isPost) {\n            this.ctx.status = 400; //不是post 请求\n            this.ctx.message = 'only post request is accetp.';\n            return;\n        }\n        var img_url = this.post('img_url');\n        var img_type = this.post('img_type');\n        var isInsertOk = await this.model('think_qrcode_say').insertImgUrl(img_url, img_type);\n        console.log('insertUrlToQrcodesayDataAction ====> img_url = ' + img_url + ' img_type = ' + img_type + ' isInsertOk = ' + isInsertOk);\n        if (isInsertOk) {\n            var obj = new Object();\n            obj.result_code = 200;\n            obj.result_msg = 'success';\n            return this.ctx.json(obj);\n        } else {\n            var obj = new Object();\n            obj.result_code = 401;\n            obj.result_msg = 'failes';\n            return this.ctx.json(obj);\n        }\n    }\n\n    /**\n     *  http://127.0.0.1:8360/admin/qrcodeapi/getQrcodesayConfigData\n     */\n    async getQrcodesayConfigDataAction() {\n        var qrCodeSayConfigData = await this.model('think_qrcode_say').getQrCodeSayList();\n        // console.log('getQrcodesayConfigDataAction1111 =====> ' + JSON.stringify(qrCodeSayConfigData));\n        return this.ctx.json(qrCodeSayConfigData);\n    }\n\n\n    /**\n     *  http://127.0.0.1:8360/admin/qrcodeapi/saveQrCodeSayConfig\n     */\n    async saveQrCodeSayConfigAction() {\n        var id = this.post('id');\n        var img_url = this.post('img_url');\n        var view_numbs = this.post('view_numbs');\n        var tap_liked_numbs = this.post('tap_liked_numbs');\n        // var create_date = this.post('create_date');\n        // var last_modify_date = this.post('last_modify_date');\n        var img_type = this.post('img_type');\n\n\n        //插入数据\n        try {\n            let addID = await this.model('think_qrcode_say')\n                .add({\n                    id: id,\n                    img_url: img_url,\n                    view_numbs: view_numbs,\n                    tap_liked_numbs: tap_liked_numbs,\n                    // create_date: create_date,\n                    // last_modify_date: last_modify_date,\n                    img_type: img_type,\n                });\n            console.log('saveAdConfigAction22222====>  addID = ' + addID);\n        } catch (error) {\n            var response = new Object();\n            response.isError = true;\n            response.msg = '保存失败，数据格式有问题';\n            console.log('saveAdConfigAction3333===> : ' + this.ctx.json(response));\n            return this.ctx.json(response);\n        }\n\n        //返回跟新后的数据\n        let newData = await this.model('think_qrcode_say').where({\n            id: id\n        }).select();\n        console.log('saveQrCodeMusicAction4444====> newData = ' + JSON.stringify(newData));\n        return this.ctx.json(newData);\n    }\n\n    /**\n     *  http://127.0.0.1:8360/admin/qrcodeapi/updateQrCodeSayConfig\n     */\n    async updateQrCodeSayConfigAction() {\n        var id = this.post('id');\n        var img_url = this.post('img_url');\n        var view_numbs = this.post('view_numbs');\n        var tap_liked_numbs = this.post('tap_liked_numbs');\n        // var create_date = this.post('create_date');\n        // var last_modify_date = this.post('last_modify_date');\n        var img_type = this.post('img_type');\n\n        //更新数据\n        let affectedRows = await this.model('think_qrcode_say')\n            .where({\n                id: id\n            })\n            .update({\n                id: id,\n                img_url: img_url,\n                view_numbs: view_numbs,\n                tap_liked_numbs: tap_liked_numbs,\n                // create_date: create_date,\n                // last_modify_date: last_modify_date,\n                img_type: img_type,\n            });\n        //返回跟新后的数据\n        if (affectedRows <= 0) {\n            var response = new Object();\n            response.isError = true;\n            response.msg = '数据更新是败';\n            console.log('saveH5TypeAction : ' + this.ctx.json(response));\n            return this.ctx.json(response);\n        }\n        let newData = await this.model('think_qrcode_say').where({\n            id: id\n        }).select();\n        console.log('updateH5TypeAction newData = ' + JSON.stringify(newData));\n        return this.ctx.json(newData);\n    }\n\n\n    /**\n     *  http://127.0.0.1:8360/admin/qrcodeapi/deleteQrCodeSay\n     */\n    async deleteQrCodeSayAction() {\n        var id = this.post('id'); //easyui 删除post参数是id，此处在html中已经和qr_type_id 绑定\n        //跟新数据\n        let affectedRows = await this.model('think_qrcode_say')\n            .where({\n                id: id\n            })\n            .delete();\n        //返回跟新后的数据\n        if (affectedRows <= 0) {\n            var response = new Object();\n            response.isError = true;\n            response.msg = '删除数据失败';\n            console.log('deleteAdConfigAction2222 ====>' + +this.ctx.json(response));\n            return this.ctx.json(response);\n        }\n        var response = new Object();\n        response.success = true; //返回true 响应删除成功，页面刷新\n        return this.ctx.json(response);\n\n    }\n\n    /******************************工具方法************************************************************** */\n    /**\n     * 判断是否已经登录\n     */\n    async isLogined() {\n        var userInfo = await this.session('userInfo');\n        console.log('isLogined = ' + !think.isEmpty(userInfo) + \".....\");\n        return !think.isEmpty(userInfo);\n    }\n}"
    ]
}